<html>
<head>
    <title>Final Project (5)</title>
</head>
<body>

    <canvas id="myCanvas"></canvas>

<script type="module">


/**
 * Forest Walk Project
 * By:
 *  - Derek Costello
 *  - Alexander Elguezabal
 * 
 *  WASD keys to move around
 *  Moving the mouse pans your vision
 * 
 *  To view the sun press(o)
 *  To view the moon press(p)
 */

import * as THREE from "http://cs.merrimack.edu/~stuetzlec/three.js-master/build/three.module.js";
import { DragControls } from "http://cs.merrimack.edu/~stuetzlec/three.js-master/examples/jsm/controls/DragControls.js";

// Define scene
var scene = new THREE.Scene();

// Camera
var camera = new THREE.PerspectiveCamera( 35, window.innerWidth / window.innerHeight, .1, 3000 );
camera.position.set(0, 3, 20);
camera.lookAt( new THREE.Vector3(0.0,0.0,0.0));
scene.add( camera );

// Define renderer
var renderer = new THREE.WebGLRenderer({canvas: myCanvas, antialias: true});
renderer.setClearColor(0x000000);
renderer.setSize(window.innerWidth, window.innerHeight);
renderer.setPixelRatio(window.devicePixelRatio);
renderer.shadowMap.enabled = true;

// Got function from https://codepen.io/anon/pen/qNNNzJ
window.addEventListener('resize', function(e){
  var width = window.innerWidth, height = window.innerHeight;
  camera.aspect = width / height;
  camera.updateProjectionMatrix();
  renderer.setSize(width, height);
  renderer.render(scene, camera);
});

// Add the directional light
const dirLight = new THREE.DirectionalLight(0xffffff);
const backLight = new THREE.DirectionalLight(0x212121);

dirLight.castShadow = true;
dirLight.shadow.mapSize.width = 2048;
dirLight.shadow.mapSize.height = 2048;
dirLight.position.set(20, 30, 15);

backLight.position.set(-20, -30, -15);
scene.add(dirLight);
scene.add(backLight);

// Set the stage
var planeGeom = new THREE.PlaneGeometry(15, 15);
var planeMat = new THREE.MeshPhongMaterial({color: new THREE.Color("orange"), side: THREE.DoubleSide});
const plane = new THREE.Mesh(planeGeom, planeMat);
plane.rotation.x += Math.PI / 2;
plane.position.y -= 2;
plane.receiveShadow = true;

scene.add(plane);

var sphereGeom = new THREE.SphereGeometry(1, 16, 16);
var sphere1 = new THREE.Mesh(sphereGeom, new THREE.MeshPhongMaterial({color: Math.random() * 0xffffff}));
var sphere2 = new THREE.Mesh(sphereGeom, new THREE.MeshPhongMaterial({color: Math.random() * 0xffffff}));

scene.add(sphere1, sphere2);

sphere1.position.set(5, 0, 0);
sphere2.position.set(-5, 0, 0);

var draggables = [];
draggables.push(sphere1);

const controls = new DragControls(draggables, camera, renderer.domElement);

// Particle mechanics
function Particle(object) {
    this.obj = object
    this.acc;
    this.vel;
    this.mass = 10;
    this.applyForce = function(force) { // Input: Vec3 Force
        this.acc = force / mass;
    }
    this.update = function (dt) { // Input: DeltaTime (in seconds)
        this.vel = this.acc * dt;
    }
}

// Does the animation
function animate() {
    requestAnimationFrame(animate);

    render();
}

function render() {
    renderer.render(scene, camera);
}


// Initiate graphical loop
animate();

    </script>

</body>
</html>