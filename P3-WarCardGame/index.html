<html>
<head>
    <title>(Project 3) War Card Game</title>
    <!--"Blocker" Code Grabbed from: https://threejs.org/examples/misc_controls_pointerlock.html -->
    <style>
     
    </style>
</head>
<body>


<canvas id="myCanvas"></canvas>

<script type="module">

// Objects & Functions
// Gets a random number
// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/random
function getRandomArbitrary(min, max) {
  return Math.random() * (max - min) + min;
}

// Gets a random integer
// https://stackoverflow.com/questions/1527803/generating-random-whole-numbers-in-javascript-in-a-specific-range
function getRandomArbitraryInt(min, max) {
    min = Math.ceil(min);
    max = Math.floor(max);
    return Math.floor(Math.random() * (max - min + 1)) + min;
}

/**
 * Asteroid Blitzer 
 * By Derek Costello and Alexander Elguezabl
 * 
 * Please host a server to run the project, we are hosting textures.
 * 
 * Two Cool Features:
 *  - Added looping game music
 *  - Asteroids explode on-contact
 *  - Asteroids have a small texture
 * 
 * Our resterization technique used is Depth Test on smaller asteroids that are created when a large one is colided with.
 * Along with scisoring for the rear-view plane.
 * 
 * If you have any questions please let us know!
 * 
 */

// Start of Javascript code
import * as THREE from "http://cs.merrimack.edu/~stuetzlec/three.js-master/build/three.module.js";
import { ConvexGeometry } from "http://cs.merrimack.edu/~stuetzlec/three.js-master/examples/jsm/geometries/ConvexGeometry.js";
import { DragControls } from 'http://cs.merrimack.edu/~stuetzlec/three.js-master/examples/jsm/controls/DragControls'
import { PointerLockControls } from 'http://cs.merrimack.edu/~stuetzlec/three.js-master/examples/jsm/controls/PointerLockControls'

/**
 * Initilization function, creating scene, camera, and objects.
 */
// Creating Scene
var scene = new THREE.Scene();
//scene.fog = new THREE.FogExp2( 0xefd1b5, 0.0005 );

// Renderer 
var renderer = new THREE.WebGLRenderer({canvas: myCanvas, antialias: true});
//renderer.setClearColor( 0xffffff, 1 );
//renderer.setClearColor( new THREE.Color( 'aqua' ), 1 );
// If you want this to span the window, instead of using the myCanvas object, use the window object
renderer.setPixelRatio(window.devicePixelRatio * 1.01);
renderer.setSize(window.innerWidth, window.innerHeight * 1);
renderer.setClearColor(0x000000);
renderer.shadowMap.enabled = true;
renderer.shadowMap.type = THREE.PCFSoftShadowMap;

// Automiattically adjusts video based on resize.
document.body.appendChild( renderer.domElement );
window.addEventListener( 'resize', function() {
    var width = window.innerWidth;
    var height = window.innerHeight;
    renderer.setSize( width, height );
});

// Adding a camera
var camera = new THREE.PerspectiveCamera( 35, window.innerWidth / window.innerHeight, .1, 3000 );
camera.position.z = 20;  // Try moving this around!
camera.lookAt( new THREE.Vector3(0.0,0.0,0.0));
scene.add( camera );

// Light
var light = new THREE.AmbientLight( 0x404040, 5 )
//light.position.set( 0, 0, camera.position.z );
//light.castShadow = true;            // default false
//light.shadow.mapSize.width = 1024;  // default 512
//light.shadow.mapSize.height = 1024; // default 512
//light.shadow.camera.near = 2;       // default 0.5
//light.shadow.camera.far = 1500;  
scene.add( light );


// Texture loader
const loader = new THREE.TextureLoader();
const cardColor = new THREE.Color( 'white' );

// Card object class
function Card( name, filename, value, suit ) {

    this.name = name;
    this.fileName = filename;
    this.value = value;
    this.suit = suit;

    this.init = function() {
        
        this.geometry = new THREE.BoxGeometry( 0.1, 7, 3 );
        this.texture = new THREE.MeshStandardMaterial({
                                            color: cardColor,
                                            map: loader.load(this.fileName)
                                        });
        this.card = new THREE.Mesh( this.geometry, this.texture ); 
    }

}

// Init all cards
var cards = [];

cards.push(new Card("2_of_clubs", `./media/cards/2_of_clubs.jpg`, 2, "clubs"));
cards.push(new Card("2_of_diamonds", `./media/cards/2_of_diamonds.jpg`, 2, "diamonds"));
cards.push(new Card("2_of_spades", `./media/cards/2_of_spades.jpg`, 2, "spades"));
cards.push(new Card("2_of_hearts", `./media/cards/2_of_hearts.jpg`, 2, "hearts"));

cards.push(new Card("3_of_clubs", `./media/cards/3_of_clubs.jpg`, 3, "clubs"));
cards.push(new Card("3_of_diamonds", `./media/cards/3_of_diamonds.jpg`, 3, "diamonds"));
cards.push(new Card("3_of_spades", `./media/cards/3_of_spades.jpg`, 3, "spades"));
cards.push(new Card("3_of_hearts", `./media/cards/3_of_hearts.jpg`, 3, "hearts"));

cards.push(new Card("4_of_clubs", `./media/cards/4_of_clubs.jpg`, 4, "clubs"));
cards.push(new Card("4_of_diamonds", `./media/cards/4_of_diamonds.jpg`, 4, "diamonds"));
cards.push(new Card("4_of_spades", `./media/cards/4_of_spades.jpg`, 4, "spades"));
cards.push(new Card("4_of_hearts", `./media/cards/4_of_hearts.jpg`, 4, "hearts"));

// Initilize all cards
cards.forEach((card) => {
    console.log(card);
    card.init();
});

cards[0].card.position.set(0, 0, 0);
console.log(cards[0].card );
scene.add( cards[0].card );


document.addEventListener('keypress', keypressed);

function keypressed( event )
{
    switch(event.key) {
        // Nothing atm
    }		
}

function animate() {
    cards[0].card.rotation.y += 0.001;

    requestAnimationFrame(animate);
    render();
}

function render() {
    renderer.render( scene , camera );
}

animate();

animate();

</script>

</body>
</html>